<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard - YM Finance</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f3e5f5; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
    .stats { display: flex; gap: 20px; margin-bottom: 30px; }
    .stat-card { 
      background: white; 
      padding: 20px; 
      border-radius: 8px; 
      flex: 1;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .stat-number { font-size: 32px; font-weight: bold; color: #6a1b9a; }
    .stat-label { color: #666; margin-top: 5px; }
    .section { margin-bottom: 30px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .section h2 { border-bottom: 2px solid #6a1b9a; padding-bottom: 10px; color: #6a1b9a; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background-color: #f3e5f5; font-weight: bold; }
    .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
    .status-pending { background: #fff3cd; color: #856404; }
    .status-approved { background: #d4edda; color: #155724; }
    .status-rejected { background: #f8d7da; color: #721c24; }
    .nav-menu { margin-top: 20px; }
    .nav-menu a { 
      display: inline-block; 
      margin-right: 15px; 
      padding: 8px 16px; 
      background: #6a1b9a; 
      color: white; 
      text-decoration: none; 
      border-radius: 4px; 
    }
    .nav-menu a:hover { background: #4a148c; }
    .amount { text-align: right; font-weight: bold; color: #6a1b9a; }
  </style>
</head>
<body>
  <div class="header">
    <div>
      <h1 style="color: #6a1b9a;">Admin Dashboard</h1>
      <p>Welcome, Administrator</p>
    </div>
    <div>
      <a href="{% url 'logout' %}" style="color: #dc3545; font-weight: bold;">Logout</a>
    </div>
  </div>

  <div class="stats">
    <div class="stat-card">
      <div class="stat-number">{{ stats.pending }}</div>
      <div class="stat-label">Pending Requests</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">{{ stats.approved }}</div>
      <div class="stat-label">Approved</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">{{ stats.rejected }}</div>
      <div class="stat-label">Rejected</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">{{ stats.total }}</div>
      <div class="stat-label">Total Requests</div>
    </div>
  </div>

  <div class="nav-menu">
    <a href="{% url 'pending_requests' %}">Review Pending Requests</a>
    <a href="{% url 'create_account' %}">Create New User</a>
    <a href="{% url 'budget_request_list' %}">All Budget Requests</a>
    <a href="{% url 'monthly_report' %}">Monthly Reports</a>
  </div>

  <div class="section">
    <h2>Monthly Budget Report</h2>
    {% if monthly_report %}
      <table>
        <thead>
          <tr>
            <th>City</th>
            <th>Month</th>
            <th class="amount">Total Amount ($)</th>
          </tr>
        </thead>
        <tbody>
          {% for report in monthly_report %}
          <tr>
            <td>{{ report.0 }}</td>
            <td>{{ report.1 }}</td>
            <td class="amount">${{ report.2|floatformat:2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No monthly data available.</p>
    {% endif %}
  </div>

  <div class="section">
    <h2>Pending Requests (Top 10)</h2>
    {% if pending_requests %}
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>City</th>
            <th>Month</th>
            <th>Description</th>
            <th>Requester</th>
            <th>Submitted</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for req in pending_requests %}
          <tr>
            <td>{{ req.0 }}</td>
            <td>{{ req.1 }}</td>
            <td>{{ req.2 }}</td>
            <td>{{ req.3|truncatewords:10 }}</td>
            <td>{{ req.5 }}</td>
            <td>{{ req.6|date:"Y-m-d" }}</td>
            <td><a href="{% url 'request_detail' req.0 %}" style="color: #6a1b9a; font-weight: bold;">Review</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No pending requests.</p>
    {% endif %}
  </div>

  <div class="section">
    <h2>Recent Activity (All Requests)</h2>
    {% if recent_activity %}
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>City</th>
            <th>Month</th>
            <th>Status</th>
            <th>Requester</th>
            <th>Submitted</th>
          </tr>
        </thead>
        <tbody>
          {% for req in recent_activity %}
          <tr>
            <td>{{ req.0 }}</td>
            <td>{{ req.1 }}</td>
            <td>{{ req.2 }}</td>
            <td>
              <span class="status status-{{ req.3|lower }}">{{ req.3 }}</span>
            </td>
            <td>{{ req.4 }}</td>
            <td>{{ req.5|date:"Y-m-d H:i" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No recent activity.</p>
    {% endif %}
  </div>
</body>
</html>
